version: 2.1

jobs:
  test:
    parameters:
      php-version:
        type: string
    docker:
      - image: cimg/php:<< parameters.php-version >>
    steps:
      - checkout

      - run:
          name: Install Composer dependencies
          command: composer install

      - run:
          name: Lint
          command: ./bin/lint src

      - run:
          name: PHPUnit
          command: ./vendor/bin/phpunit --bootstrap vendor/autoload.php tests

workflows:
  build-and-test:
    jobs:
      - test:
          matrix:
            parameters:
              php-version:
                - "8.0"
                - "8.1"
                - "8.2"
                - "8.3"
                - "8.4"
                - "8.5"
